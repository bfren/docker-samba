#!/bin/sh

set -euo pipefail
export BF_E=`basename ${0}`


#======================================================================================================================
# Get Samba version.
#======================================================================================================================

cd /tmp

VERSION=$(cat SAMBA_BUILD)
bf-echo "Samba version ${VERSION}."


#======================================================================================================================
# Install Samba and dependencies.
#======================================================================================================================

bf-echo "Installing Samba v${VERSION}..."
apk add --no-cache \
    bash \
    jq \
    samba=${VERSION}
bf-done


#======================================================================================================================
# Create directory not created by installation package.
#======================================================================================================================

CORES=/usr/local/samba/var/cores
mkdir -p ${CORES}
bf-ch -m 0700 -t d ${CORES}


#======================================================================================================================
# Cleanup.
#======================================================================================================================

bf-done
